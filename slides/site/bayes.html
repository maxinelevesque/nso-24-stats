<!DOCTYPE html>
<html lang="en"><head>
<script src="bayes_files/libs/clipboard/clipboard.min.js"></script>
<script src="bayes_files/libs/quarto-html/tabby.min.js"></script>
<script src="bayes_files/libs/quarto-html/popper.min.js"></script>
<script src="bayes_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="bayes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="bayes_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="bayes_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="bayes_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Maxine Collard">
  <title>Gaining knowledge from tests</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="bayes_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="bayes_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="bayes_files/libs/revealjs/dist/theme/quarto.css">
  <link href="bayes_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="bayes_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="bayes_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="bayes_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Gaining knowledge from tests</h1>
  <p class="subtitle">UCSF Neuroscience Orientation 2024</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Maxine Collard 
</div>
</div>
</div>

</section>
<section>
<section id="a-clairvoyant-mouse" class="title-slide slide level1 center" data-background-color="bisque">
<h1>A clairvoyant mouse?</h1>

</section>
<section id="a-clairvoyant-mouse-1" class="slide level2">
<h2>A clairvoyant mouse?</h2>
<div class="fragment">
<p><br>
<br>
You look at your data, and you see that you <strong>reject the null hypothesis</strong> that <em>manipulated mice do not predict the future</em> with a <span class="math inline">\(p\)</span>-value of 0.014.<br>
<br>
<br>
</p>
</div>
<div class="fragment">
<!-- -->
<h3 id="what-do-you-do-with-this-information">What do you do with this information?</h3>
</div>
</section></section>
<section>
<section id="lets-think-about-it-another-way" class="title-slide slide level1 center" data-background-color="LightSalmon">
<h1>Let’s think about it another way</h1>
<p>&nbsp;</p>
<blockquote>
<p><strong>N.B.:</strong> This example was originally made in September 2021, and has become less relatable over time.</p>
</blockquote>
</section>
<section id="lets-think-about-it-another-way-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Let’s think about it another way</h2>
<div class="fragment">
<p><br>
<br>
For the last four weeks, you’ve been doing nothing but sitting in your room alone studying for your qualifying exam, with <strong>absolutely zero human contact</strong>.</p>
</div>
<div class="fragment fade-down">
<p><br>
You take it and pass—<strong>hooray!</strong></p>
</div>
</section>
<section id="lets-think-about-it-another-way-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Let’s think about it another way</h2>
<p><br>
But while you’ve been away studying, UCSF has announced a new policy requiring all graduate students to be tested for Covid-19 daily. You must provide a negative test result before entering any research building on-campus!</p>
<div class="fragment">
<blockquote>
<p><em>No, not really.</em></p>
</blockquote>
</div>
<div class="fragment">
<p><br>
You grab a test from one of the Color vending machines and wait at home for the results to come back. The next day, you get an email:</p>
</div>
</section>
<section class="slide level2">

<p><br>
&nbsp;</p>
<h3 id="sars-cov-2-mrna"><code>SARS-CoV-2 mRNA:</code></h3>
<div class="fragment fade-down">
<!-- -->
<h3 id="detected"><code>DETECTED</code></h3>
</div>
<p>&nbsp;</p>
<div class="fragment">
<!-- -->
<h3 id="do-you-think-you-have-covid">Do you think you have Covid?</h3>
</div>
<p>&nbsp;</p>
<div class="fragment">
<!-- -->
<h3 id="why-do-you-think-that">Why do you think that?</h3>
</div>
</section></section>
<section>
<section id="lets-try-a-simulation" class="title-slide slide level1 center" data-background-color="SeaGreen">
<h1>Let’s try a simulation!</h1>

</section>
<section id="the-scenario" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">The scenario</h2>
<blockquote>
<p><strong>N.B.</strong>: SF no longer tracks Covid case rates, so I’ll be using last year’s numbers.</p>
</blockquote>
<div class="fragment">
<ul>
<li>Current rolling average for reported Covid cases in San Francisco: ~65 per day.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>SF’s population is ~815,000. So, <strong>reported</strong> incidence of Covid in SF: ~7.97 per 100,000 per day.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Let’s aim high: assume Covid incidence is <strong>4x reported</strong>: ~31.88 per 100,000 per day.</li>
</ul>
</div>
</section>
<section id="the-scenario-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">The scenario</h2>
<p>&nbsp;</p>
<ul>
<li>To get to prevalence, let’s assume everyone infected has Covid for 14 days.</li>
</ul>
<div class="fragment">
<ul>
<li>So, ballpark prevalence of Covid in SF: ~<strong>111.6 per 100,000</strong>.</li>
</ul>
</div>
<div class="fragment">
<blockquote>
<p>If you were to pick a person at random from San Francisco with no other knowledge, this would be about the chance of picking someone who currently has Covid.</p>
</blockquote>
</div>
</section>
<section id="section" class="slide level2 center">
<h2>&nbsp;</h2>
<div class="sourceCode" id="cb1" data-code-line-numbers="10-11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="co"># September 2021 (using reported case count)</span></span>
<span id="cb1-2"><a href=""></a><span class="co"># covid_prevalence = 350 / 100000</span></span>
<span id="cb1-3"><a href=""></a></span>
<span id="cb1-4"><a href=""></a><span class="co"># August 2022 (using reported case count)</span></span>
<span id="cb1-5"><a href=""></a><span class="co"># covid_prevalence = 288.4 / 100000</span></span>
<span id="cb1-6"><a href=""></a></span>
<span id="cb1-7"><a href=""></a><span class="co"># September 2023 (using 4x reported case count)</span></span>
<span id="cb1-8"><a href=""></a><span class="co"># covid_prevalence = 446.32 / 100000</span></span>
<span id="cb1-9"><a href=""></a></span>
<span id="cb1-10"><a href=""></a><span class="co"># September 2024 (no more case counts, using 2023 data)</span></span>
<span id="cb1-11"><a href=""></a>covid_prevalence <span class="op">=</span> <span class="fl">446.32</span> <span class="op">/</span> <span class="dv">100000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<h3 id="section-1">&nbsp;</h3>
</section>
<section id="recall" class="slide level2">
<h2>Recall</h2>
<p>&nbsp;</p>
<p>The <span class="math inline">\(p\)</span>-value is defined by thinking about what our observations would be by chance if we <strong>presuppose that the null hypothesis is in fact true</strong>:</p>
<div class="fragment">
<p><span class="math display">\[ p = \mathrm{Pr}(\textrm{we observe a difference} \mid \textrm{there is no difference}) \]</span></p>
</div>
<div class="fragment">
<blockquote>
<p>This is convenient to use, because we can always <strong>impose</strong> the null hypothesis by shuffling our data. This is called <strong>permutation testing</strong>.</p>
</blockquote>
</div>
</section>
<section id="section-2" class="slide level2" data-background-color="black" data-background-image="figures/ppv/f7.png" data-background-size="contain">
<h2>&nbsp;</h2>
</section>
<section id="section-3" class="slide level2" data-background-color="black" data-background-image="figures/ppv/f6.png" data-background-size="contain">
<h2>&nbsp;</h2>
</section>
<section class="slide level2">

<p>Usually, diagnostic tests are evaluated kind of like <span class="math inline">\(p\)</span>-values: we use measures that ask how the <em>test</em> behaves when we <strong>pre-suppose the truth</strong>.</p>
<div class="fragment">
<p><strong>Sensitivity</strong> measures the probability that a person tests positive <strong>given that they actually have the disease</strong>:</p>
<p><span class="math display">\[ \mathrm{sensitivity} := \mathrm{Pr}(\textrm{test }+ \mid \textrm{actually }+) \]</span></p>
</div>
<div class="fragment">
<p><strong>Specificity</strong> measures the probability that a person tests negative <strong>given that they actually <em>do not</em> have the disease</strong>:</p>
<p><span class="math display">\[ \mathrm{specificity} := \mathrm{Pr}(\textrm{test }- \mid \textrm{actually }-) \]</span></p>
</div>
</section>
<section id="section-4" class="slide level2" data-background-color="black" data-background-image="figures/ppv/f8.png" data-background-size="contain">
<h2>&nbsp;</h2>
</section>
<section id="section-5" class="slide level2" data-background-color="LightCyan">
<h2></h2>
<blockquote>
<p><strong>N.B.</strong>: The <span class="math inline">\(p\)</span>-value can be thought of as</p>
<p><span class="math display">\[ p = \mathrm{Pr}(\textrm{test }+ \mid \textrm{actually }-) \]</span></p>
<div class="fragment">
<p>Because there are only two test outcomes, <span class="math inline">\(+\)</span> and <span class="math inline">\(-\)</span>, this means that</p>
<p><span class="math display">\[\begin{eqnarray*}
p &amp; = &amp; 1 - \mathrm{Pr}(\textrm{test }- \mid \textrm{actually }-) \\
&amp; = &amp; 1 - \mathrm{specificity}
\end{eqnarray*}\]</span></p>
</div>
<div class="fragment">
<p>So, the <span class="math inline">\(p\)</span>-value is in the same “family” of measures about a test as sensitivity and specificity.</p>
</div>
</blockquote>
</section>
<section id="back-to-the-code" class="slide level2">
<h2>Back to the code</h2>
<div class="fragment">
<p>Let’s suppose that the currently used RT-PCR test for Covid has approximately the following characteristics:</p>
<div class="sourceCode" id="cb2" data-code-line-numbers="7,9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href=""></a><span class="co"># September 2021</span></span>
<span id="cb2-2"><a href=""></a><span class="co"># rtpcr_sensitivity = 0.777</span></span>
<span id="cb2-3"><a href=""></a><span class="co"># rtpcr_specificity = 0.988</span></span>
<span id="cb2-4"><a href=""></a></span>
<span id="cb2-5"><a href=""></a><span class="co"># August 2022</span></span>
<span id="cb2-6"><a href=""></a><span class="co"># https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7350782/</span></span>
<span id="cb2-7"><a href=""></a>rtpcr_sensitivity <span class="op">=</span> <span class="fl">0.733</span></span>
<span id="cb2-8"><a href=""></a><span class="co"># https://www.uptodate.com/contents/covid-19-diagnosis</span></span>
<span id="cb2-9"><a href=""></a>rtpcr_specificity <span class="op">=</span> <span class="fl">0.97</span></span>
<span id="cb2-10"><a href=""></a></span>
<span id="cb2-11"><a href=""></a><span class="co"># September 2023: These characteristics haven't appreciably changed</span></span>
<span id="cb2-12"><a href=""></a></span>
<span id="cb2-13"><a href=""></a><span class="co"># September 2024: "</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<blockquote>
<p><strong>N.B.</strong>: Finding accurate values is challenging in practice.</p>
</blockquote>
</div>
</section>
<section id="section-6" class="slide level2 center" data-background-color="LightCyan">
<h2></h2>
<blockquote>
<p><strong>N.B.</strong>: We can compute the <span class="math inline">\(p\)</span>-value of this test using the formula from earlier, <span class="math inline">\(1 - \textrm{specificity}\)</span>:</p>
</blockquote>
<p><br>
</p>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href=""></a><span class="bu">print</span>( <span class="ss">f'&gt; $p$ = **</span><span class="sc">{</span><span class="dv">1</span> <span class="op">-</span> rtpcr_specificity<span class="sc">:0.4f}</span><span class="ss">**'</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<blockquote>
<p><span class="math inline">\(p\)</span> = <strong>0.0300</strong></p>
</blockquote>
</section></section>
<section>
<section id="you-just-got-a-positive-test" class="title-slide slide level1 center" data-background-color="purple">
<h1>You just got a positive test</h1>
<div class="fragment">
<p>&nbsp;</p>
<p>What do the sensitivity and specificity <strong>tell</strong> you?</p>
</div>
</section>
<section class="slide level2">

<p>You already <strong>know</strong> that you’ve tested positive. What you would like to <strong>infer</strong> is whether or not you actually have Covid.</p>
<div class="fragment">
<p>&nbsp;</p>
<h3 id="sensitivity-and-specificity-do-not-tell-you-this.">Sensitivity and specificity do not tell you this.</h3>
<p>And so, neither do <span class="math inline">\(p\)</span>-values!</p>
</div>
<div class="fragment">
<p><br>
What you want to know are the quantities with the <strong>opposite conditioning</strong>:</p>
</div>
<div class="fragment fade-in-then-semi-out">
<p><span class="math display">\[
p = \mathrm{Pr}(\textrm{test }+ \mid \textrm{actually }-)
\]</span></p>
</div>
<div class="fragment fade-down">
<p><span class="math display">\[
\textrm{?} = \mathrm{Pr}(\textrm{actually }+ \mid \textrm{test }+)
\]</span></p>
</div>
<h3 id="section-7">&nbsp;</h3>
</section>
<section id="section-8" class="slide level2" data-background-color="black" data-background-image="figures/ppv/f9.png" data-background-size="contain">
<h2>&nbsp;</h2>
</section>
<section class="slide level2">

<p><strong>Positive predictive value</strong> is the probability one <em>actually has the disease</em> <strong>given</strong> a positive test result:</p>
<p><span class="math display">\[ \mathrm{PPV} := \mathrm{Pr}(\textrm{actually }+ \mid \textrm{test }+) \]</span></p>
<div class="fragment">
<blockquote>
<p>Now that you have a positive Covid test, the <strong>PPV</strong> is the probability that you <strong>actually</strong> have Covid.</p>
</blockquote>
</div>
<div class="fragment">
<p><strong><br>
Negative predictive value</strong> is the probability one <em>actually does not have the disease</em> <strong>given</strong> a negative test result:</p>
<p><span class="math display">\[ \mathrm{NPV} := \mathrm{Pr}(\textrm{actually }- \mid \textrm{test }-) \]</span></p>
</div>
</section>
<section id="section-9" class="slide level2" data-background-color="black" data-background-image="figures/ppv/f10.png" data-background-size="contain">
<h2>&nbsp;</h2>
</section>
<section id="what-do-you-think-are-the-ppv-and-npv-for-the-rt-pcr-test" class="slide level2 center">
<h2>What do you think are the PPV and NPV for the RT-PCR test?</h2>
</section>
<section id="section-10" class="slide level2" data-background-color="LightCyan">
<h2></h2>
<blockquote>
<p><strong>N.B.</strong>: Always write docstrings for your code:</p>
</blockquote>
<p><br>
</p>
<div id="ecd38a89" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href=""></a><span class="bu">help</span>( sample_results )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Help on function sample_results in module __main__:

sample_results(n, prevalence, sensitivity, specificity)
    Sample disease presence and test results with the given characteristics

    Arguments:
    n -- The number of individiuals to sample
    prevalence -- The probability of finding the actual disease in the population
    sensitivity -- The probability of testing positive given one has the disease
    specificity -- The probability of testing negative given one does not have the disease

    Reutrns:
    has_disease -- Shape (n,), whether each individual has the disease
    test_results -- Shape (n,), whether each individual tests positive for the disease
</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Let’s simulate one day of Covid tests at UCSF:</p>
<div class="fragment">
<div id="7b966c64" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href=""></a><span class="co"># Approximately the number of employees at UCSF</span></span>
<span id="cb6-2"><a href=""></a>n_employees <span class="op">=</span> <span class="dv">24000</span></span>
<span id="cb6-3"><a href=""></a><span class="co"># Run our simulation and grab the results</span></span>
<span id="cb6-4"><a href=""></a><span class="co"># (See code for the slides online)</span></span>
<span id="cb6-5"><a href=""></a>has_covid, rtpcr_positive <span class="op">=</span> sample_results( n_employees,</span>
<span id="cb6-6"><a href=""></a>                                            covid_prevalence,</span>
<span id="cb6-7"><a href=""></a>                                            rtpcr_sensitivity,</span>
<span id="cb6-8"><a href=""></a>                                            rtpcr_specificity )</span>
<span id="cb6-9"><a href=""></a><span class="co"># If I put an f in front of my string, I can use curly braces to</span></span>
<span id="cb6-10"><a href=""></a><span class="co"># put Python code inside of it</span></span>
<span id="cb6-11"><a href=""></a><span class="bu">print</span>( <span class="ss">f'&gt; Cases today: **</span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">sum</span>( has_covid )<span class="sc">}</span><span class="ss">**</span><span class="ch">\\</span><span class="ss">'</span> )</span>
<span id="cb6-12"><a href=""></a><span class="bu">print</span>( <span class="ss">f'&gt; Positive tests today: **</span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">sum</span>( rtpcr_positive )<span class="sc">}</span><span class="ss">**'</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment" data-execution_count="6">
<blockquote>
<p>Cases today: <strong>103</strong><br>
Positive tests today: <strong>817</strong></p>
</blockquote>
</div>
</div>
<div class="fragment">
<p>Clearly something funky is going on: <strong>there are way more positive tests than cases</strong>!</p>
</div>
</section>
<section class="slide level2">

<p>As is always good practice, let’s take a look at a subsample of the raw data:</p>
<div id="58ef8425" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href=""></a><span class="co"># Subplots allows us to lay out some axes (`ax`) inside of a</span></span>
<span id="cb7-2"><a href=""></a><span class="co"># figure (`fig`) that we can manipulate later</span></span>
<span id="cb7-3"><a href=""></a>fig, ax <span class="op">=</span> plt.subplots( figsize <span class="op">=</span> (<span class="dv">12</span>, <span class="fl">1.2</span>) )</span>
<span id="cb7-4"><a href=""></a></span>
<span id="cb7-5"><a href=""></a><span class="co"># Use the plotting function we just made on these axes</span></span>
<span id="cb7-6"><a href=""></a><span class="co"># (See code for the slides online)</span></span>
<span id="cb7-7"><a href=""></a>sample_plot( ax, has_covid, rtpcr_positive )</span>
<span id="cb7-8"><a href=""></a></span>
<span id="cb7-9"><a href=""></a><span class="co"># We're all done building the plots, we want to displaly them now</span></span>
<span id="cb7-10"><a href=""></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment" data-execution_count="8">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="bayes_files/figure-revealjs/cell-9-output-1.png" width="1042" height="149"></p>
</figure>
</div>
</div>
</div>
<div class="fragment">
<p>By eye, it <em>definitely</em> looks like there are a lot of false positives.</p>
</div>
</section>
<section id="what-are-the-ppv-and-npv" class="slide level2">
<h2>What are the PPV and NPV?</h2>
<p><br>
&nbsp;</p>
<div class="fragment">
<div id="95bb2bfc" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href=""></a><span class="co"># (See code for the slides online)</span></span>
<span id="cb8-2"><a href=""></a>ppv_naive, npv_naive <span class="op">=</span> predictive_value( has_covid, rtpcr_positive )</span>
<span id="cb8-3"><a href=""></a></span>
<span id="cb8-4"><a href=""></a><span class="co"># We can do math in our curly braces; here I convert the ratios into</span></span>
<span id="cb8-5"><a href=""></a><span class="co"># percents. The `:0.2f` at the end tells Python that I want 2 digits</span></span>
<span id="cb8-6"><a href=""></a><span class="co"># after the decimal point (not at all intuitive; blame the C people</span></span>
<span id="cb8-7"><a href=""></a><span class="co"># who wrote the original `printf` function).</span></span>
<span id="cb8-8"><a href=""></a><span class="bu">print</span>( <span class="ss">f'&gt; Naive PPV: **</span><span class="sc">{</span>ppv_naive <span class="op">*</span> <span class="dv">100</span><span class="sc">:0.2f}</span><span class="ss">%**</span><span class="ch">\\</span><span class="ss">'</span> )</span>
<span id="cb8-9"><a href=""></a><span class="bu">print</span>( <span class="ss">f'&gt; Naive NPV: **</span><span class="sc">{</span>npv_naive <span class="op">*</span> <span class="dv">100</span><span class="sc">:0.2f}</span><span class="ss">%**'</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment" data-execution_count="10">
<blockquote>
<p>Naive PPV: <strong>8.81%</strong><br>
Naive NPV: <strong>99.87%</strong></p>
</blockquote>
</div>
</div>
</section>
<section class="slide level2">

<p>Let’s talk about the good news first:</p>
<div class="fragment">
<ul>
<li>A <em>negative</em> test is <strong>extremely informative</strong>: if you receive a negative test result, you can say with almost certainty that you are in the clear.</li>
</ul>
</div>
<div class="fragment">
<p>And now, the bad news:</p>
</div>
<div class="fragment">
<ul>
<li>In this setup, a <em>positive</em> test is <strong>not very informative</strong>: in fact, if you were to receive a positive RT-PCR test, <em>there is a ~90% chance that you still don’t have Covid</em>.</li>
<li>Put another way, <strong>more than 9 out of every 10 positive tests are actually false positives</strong>.</li>
</ul>
</div>
</section>
<section id="do-you-think-this-will-scale-well" class="slide level2">
<h2>Do you think this will scale well?</h2>
<div class="fragment">
<p>Suppose quarantine lasts for 10 days (8 work days). What fraction of the workforce would have to be quarantining at any given moment from false positive tests alone?</p>
</div>
<p>&nbsp;</p>
<div class="fragment">
<div id="09f4d09f" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href=""></a><span class="co"># 10 days is the policy, but a couple of those will be a weekend</span></span>
<span id="cb9-2"><a href=""></a>quarantine_workdays <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb9-3"><a href=""></a><span class="co"># False positives *do not* have Covid *and* test positive</span></span>
<span id="cb9-4"><a href=""></a>quarantine_fp_per_day <span class="op">=</span> np.<span class="bu">sum</span>( <span class="op">~</span>has_covid <span class="op">&amp;</span> rtpcr_positive )</span>
<span id="cb9-5"><a href=""></a>quarantine_fp_simultaneous <span class="op">=</span> quarantine_fp_per_day <span class="op">*</span> quarantine_workdays</span>
<span id="cb9-6"><a href=""></a>quarantine_fraction <span class="op">=</span> quarantine_fp_simultaneous <span class="op">/</span> n_employees</span>
<span id="cb9-7"><a href=""></a></span>
<span id="cb9-8"><a href=""></a><span class="bu">print</span>( <span class="ss">f'&gt; Fraction of workforce quarantined: **</span><span class="sc">{</span>quarantine_fraction <span class="op">*</span> <span class="dv">100</span><span class="sc">:0.2f}</span><span class="ss">%**'</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment" data-execution_count="11">
<blockquote>
<p>Fraction of workforce quarantined: <strong>24.83%</strong></p>
</blockquote>
</div>
</div>
</section>
<section id="section-11" class="slide level2" data-background-color="LightCyan">
<h2></h2>
<p>But, <strong>n.b.</strong>! This test also has an extremely high <strong>accuracy</strong>—that is, the probability of the test being <em>correct</em>:</p>
<div class="fragment">
<div id="86399ab2" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href=""></a><span class="co"># == operates element by element on arrays</span></span>
<span id="cb10-2"><a href=""></a><span class="co"># `a == b` is an array where each element is `True` if the</span></span>
<span id="cb10-3"><a href=""></a><span class="co"># corresponding elements of `a` and `b` are equal</span></span>
<span id="cb10-4"><a href=""></a>accuracy_naive <span class="op">=</span> np.<span class="bu">sum</span>( has_covid <span class="op">==</span> rtpcr_positive ) <span class="op">/</span> <span class="bu">len</span>( has_covid )</span>
<span id="cb10-5"><a href=""></a></span>
<span id="cb10-6"><a href=""></a><span class="bu">print</span>( <span class="ss">f'&gt; Naive accuracy: **</span><span class="sc">{</span>accuracy_naive <span class="op">*</span> <span class="dv">100</span><span class="sc">:0.2f}</span><span class="ss">%**'</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment" data-execution_count="12">
<blockquote>
<p>Naive accuracy: <strong>96.77%</strong></p>
</blockquote>
</div>
</div>
<div class="fragment">
<p><br>
The accuracy of the test is hiding the fact that we’re actually doing quite a terrible job with the <em>positive predictive value</em>—the much more actionable piece of information—because <strong>the prevalence of Covid cases is so low</strong>!</p>
</div>
</section>
<section id="whats-going-wrong" class="slide level2 center">
<h2>What’s going wrong?</h2>
<div class="fragment">
<p>&nbsp;</p>
<h3 id="is-this-a-bad-test">Is this a bad test?</h3>
</div>
<div class="fragment">
<p>&nbsp;</p>
<h3 id="do-you-still-think-you-have-covid">Do you still think you have Covid?</h3>
</div>
</section></section>
<section>
<section id="a-better-way-to-use-covid-tests" class="title-slide slide level1 center" data-background-color="SteelBlue">
<h1>A better way to use Covid tests</h1>

</section>
<section id="a-better-way-to-use-covid-tests-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">A better way to use Covid tests</h2>
<p><br>
&nbsp;</p>
<p>In our simulation, the <strong>prevalence</strong> of Covid was thought of as <strong>the probability that someone in our sample had Covid</strong>. We took this to be the prevalence of Covid in San Francisco, under the assumption that we were testing people essentially randomly, and had no criteria for how we were selecting people to test.</p>
</section>
<section id="a-better-way-to-use-covid-tests-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">A better way to use Covid tests</h2>
<p><br>
<br>
After briefly quarantining a substantial portion of its workforce, UCSF has decided to try a new Covid testing schema.</p>
<div class="fragment">
<blockquote>
<p>In medicine, we call this “<em>continual improvement”</em>!</p>
</blockquote>
</div>
<div class="fragment">
<p>Now, <strong>only people who have an exposure to a confirmed symptomatic case</strong> will be tested.</p>
</div>
</section>
<section id="a-better-way-to-use-covid-tests-3" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">A better way to use Covid tests</h2>
<p><br>
Before, we had no clue about the people being tested. This new criterion means we have more <strong>knowledge</strong> (of the exposure).</p>
<div class="fragment">
<p>This knowledge changes our <strong>prior belief</strong>—before even running the test!—of whether or not the person being tested has Covid: we <em>expect</em> that someone who has had an exposure is more likely to have Covid than someone random from the general population.</p>
</div>
</section>
<section id="a-better-way-to-use-covid-tests-4" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">A better way to use Covid tests</h2>
<p><strong><br>
All of the characteristics of the test itself are still exactly the same</strong>—the same reagents, the same technique, everything.</p>
<p>The only thing we’ll change to simulate this new scenario is the <strong>proportion of tested people who have Covid</strong>.</p>
<div class="fragment">
<p><br>
Let’s say that an exposure to a symptomatic case of Covid carries an associated risk of infection of 5%:</p>
<div id="4085b2e0" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb11-1" class="hljs-ln-code"><a href=""></a>covid_belief_sus <span class="op">=</span> <span class="fl">0.05</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="what-do-you-think-will-happen-to-the-ppv-of-our-test-in-this-new-scheme" class="slide level2 center">
<h2>What do you think will happen to the PPV of our test in this new scheme?</h2>
<p><br>
&nbsp;</p>
<h3 id="how-about-the-npv">How about the NPV?</h3>
</section>
<section class="slide level2">

<p>Let’s run a simulation of a group of employees with suspected Covid exposure:</p>
<div class="fragment">
<div id="42e50f79" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href=""></a>n_sus <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb12-2"><a href=""></a>has_covid_sus, rtpcr_positive_sus <span class="op">=</span> sample_results( n_sus,</span>
<span id="cb12-3"><a href=""></a>                                                    covid_belief_sus,</span>
<span id="cb12-4"><a href=""></a>                                                    rtpcr_sensitivity,  <span class="co"># Same as before!</span></span>
<span id="cb12-5"><a href=""></a>                                                    rtpcr_specificity ) <span class="co"># Same as before!</span></span>
<span id="cb12-6"><a href=""></a></span>
<span id="cb12-7"><a href=""></a><span class="co"># Python is fully Unicode compatible for strings, so there's no</span></span>
<span id="cb12-8"><a href=""></a><span class="co"># reason not to include emoji 🤪</span></span>
<span id="cb12-9"><a href=""></a><span class="bu">print</span>( <span class="ss">f'&gt; Cases among the suspicious 🤔: **</span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">sum</span>( has_covid_sus )<span class="sc">}</span><span class="ss">**</span><span class="ch">\\</span><span class="ss">'</span> )</span>
<span id="cb12-10"><a href=""></a><span class="bu">print</span>( <span class="ss">f'&gt; Positive tests among the suspicious 🤔: **</span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">sum</span>( rtpcr_positive_sus )<span class="sc">}</span><span class="ss">**'</span> )</span>
<span id="cb12-11"><a href=""></a></span>
<span id="cb12-12"><a href=""></a><span class="co"># You can't use emoji in variable names, though 😢</span></span>
<span id="cb12-13"><a href=""></a><span class="co"># Got to switch to Haskell for that ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment" data-execution_count="14">
<blockquote>
<p>Cases among the suspicious 🤔: <strong>48</strong><br>
Positive tests among the suspicious 🤔: <strong>64</strong></p>
</blockquote>
</div>
</div>
</section>
<section id="dummy-check-round-2" class="slide level2">
<h2>Dummy check, round 2</h2>
<p><br>
<br>
<br>
</p>
<div id="8fd05fa2" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href=""></a>fig, ax <span class="op">=</span> plt.subplots( figsize <span class="op">=</span> (<span class="dv">12</span>, <span class="fl">1.2</span>) )</span>
<span id="cb13-2"><a href=""></a>sample_plot( ax, has_covid_sus, rtpcr_positive_sus )</span>
<span id="cb13-3"><a href=""></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment" data-execution_count="15">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="bayes_files/figure-revealjs/cell-16-output-1.png" width="1042" height="149"></p>
</figure>
</div>
</div>
</div>
</section>
<section class="slide level2">

<p>Already this is looking much more reasonable. <strong>What are the PPV and the NPV</strong>?</p>
<p><br>
<br>
</p>
<div id="7c122fec" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href=""></a>ppv_sus, npv_sus <span class="op">=</span> predictive_value( has_covid_sus, rtpcr_positive_sus )</span>
<span id="cb14-2"><a href=""></a></span>
<span id="cb14-3"><a href=""></a><span class="bu">print</span>( <span class="ss">f'&gt; Suspicious PPV: **</span><span class="sc">{</span>ppv_sus <span class="op">*</span> <span class="dv">100</span><span class="sc">:0.2f}</span><span class="ss">%**</span><span class="ch">\\</span><span class="ss">'</span> )</span>
<span id="cb14-4"><a href=""></a><span class="bu">print</span>( <span class="ss">f'&gt; Suspicious NPV: **</span><span class="sc">{</span>npv_sus <span class="op">*</span> <span class="dv">100</span><span class="sc">:0.2f}</span><span class="ss">%**'</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment" data-execution_count="16">
<blockquote>
<p>Suspicious PPV: <strong>54.69%</strong><br>
Suspicious NPV: <strong>98.61%</strong></p>
</blockquote>
</div>
</section>
<section id="aha" class="slide level2">
<h2>Aha!</h2>
<div class="fragment">
<p><br>
&nbsp;</p>
<p>The PPV has jumped dramatically, from about 10% to about <strong>60%</strong>!</p>
</div>
<div class="fragment">
<p>In this setting—where we have some <strong>additional knowledge</strong> about who we’re testing—the <strong>same exact test</strong> has become <strong>a lot more useful</strong>.</p>
</div>
</section>
<section id="section-12" class="slide level2" data-background-color="black" data-background-image="figures/ppv/f11.png" data-background-size="contain">
<h2>&nbsp;</h2>
</section>
<section id="section-13" class="slide level2 center" data-background-color="LightCyan">
<h2></h2>
<blockquote>
<p><strong>N.B.</strong>: There is no free lunch, of course!</p>
<p>The cost we pay is that the NPV in this scenario is now <em>slightly</em> lower!</p>
</blockquote>
</section>
<section id="section-14" class="slide level2 center" data-background-color="PaleGreen">
<h2></h2>
<p>The critical takeaway message is this:</p>
<div class="fragment">
<!-- -->
<h3 id="how-useful-a-test-is-depends-on-our-prior-belief-about-the-thing-were-testing-for.">How useful a test is depends on our prior belief about the thing we’re testing for.</h3>
</div>
</section>
<section id="how-much-knowledge-do-we-need" class="slide level2 center">
<h2>How much knowledge do we need?</h2>
<p><br>
Let’s see how this whole picture plays out as we “sweep through” a bunch of different possible priors.</p>
</section>
<section id="section-15" class="slide level2 center smaller">
<h2></h2>
<div id="71d64fc4" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href=""></a><span class="co"># (See code in slide repo for implementations)</span></span>
<span id="cb15-2"><a href=""></a></span>
<span id="cb15-3"><a href=""></a><span class="co"># Run our simulation</span></span>
<span id="cb15-4"><a href=""></a><span class="co"># Pick beliefs linearly spaced between 0 and 0.25</span></span>
<span id="cb15-5"><a href=""></a>covid_beliefs_sweep <span class="op">=</span> np.linspace( <span class="dv">0</span>, <span class="fl">0.25</span>, <span class="dv">100</span> )</span>
<span id="cb15-6"><a href=""></a>ppvs_sweep, npvs_sweep <span class="op">=</span> belief_sweep( rtpcr_sensitivity,</span>
<span id="cb15-7"><a href=""></a>                                       rtpcr_specificity,</span>
<span id="cb15-8"><a href=""></a>                                       covid_beliefs_sweep )</span>
<span id="cb15-9"><a href=""></a><span class="co"># Build our plot</span></span>
<span id="cb15-10"><a href=""></a>fig, ax <span class="op">=</span> plt.subplots( figsize <span class="op">=</span> (<span class="dv">12</span>, <span class="dv">4</span>) )</span>
<span id="cb15-11"><a href=""></a>plot_sweep( ax, covid_beliefs_sweep, ppvs_sweep, npvs_sweep,</span>
<span id="cb15-12"><a href=""></a>            annotations <span class="op">=</span> [(covid_prevalence, <span class="st">'k--'</span>, <span class="st">'Random testing'</span>),</span>
<span id="cb15-13"><a href=""></a>                           (covid_belief_sus, <span class="st">'m--'</span>, <span class="st">'Testing after confirmed exposure'</span>)],</span>
<span id="cb15-14"><a href=""></a>            xlabel <span class="op">=</span> <span class="st">'Prior belief of Covid'</span> )</span>
<span id="cb15-15"><a href=""></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment" data-execution_count="18">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="bayes_files/figure-revealjs/cell-19-output-1.png" width="984" height="364"></p>
</figure>
</div>
</div>
</div>
</section>
<section class="slide level2">

<p>In this example, we saw that the PPV of our Covid test depended strongly on the scheme we used to select which people to test, even while <strong>the test itself remained entirely the same</strong>.</p>
<div class="fragment">
<p>From the previous slide, even <strong>very weak improvements in our prior belief</strong> can lead to <strong>vast changes in the utility of our test</strong>!</p>
</div>
<div class="fragment">
<p><br>
This means that <strong>PPV is not just a statement about the test</strong>.</p>
</div>
<div class="fragment">
<!-- -->
<h3 id="ppv-is-a-statement-about-how-the-test-is-used.">PPV is a statement about how the test is used.</h3>
</div>
</section></section>
<section>
<section id="what-does-a-test-do" class="title-slide slide level1 center" data-background-color="Gold">
<h1>What does a test do?</h1>

</section>
<section id="what-does-a-test-do-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">What does a test do?</h2>
<p><br>
<br>
&nbsp;</p>
<p>Before we ran the test, we had some <strong>prior knowledge</strong> about whether we had Covid:</p>
<p><span class="math display">\[ \mathrm{Pr}(\textrm{actually }+) \]</span></p>
</section>
<section id="what-does-a-test-do-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">What does a test do?</h2>
<p>When we get <strong>new knowledge</strong>—the result of the test—we <strong>update</strong> our belief of whether we have Covid. Our knowledge about whether we have Covid <em>after</em> the update caused by the test is precisely the <strong>PPV</strong>:</p>
<p><span class="math display">\[\begin{eqnarray*}
&amp;\mathrm{Pr}(\textrm{actually }+) &amp; \\
&amp; \downarrow &amp; \\
&amp; \mathrm{Pr}(\textrm{actually }+ \mid \textrm{test }+) &amp;
\end{eqnarray*}\]</span></p>
<p>This is also known as the <strong>posterior probability</strong> (as in, the probability that we have <em>after</em>) given a positive test.</p>
</section>
<section id="section-16" class="slide level2" data-background-color="black" data-background-image="figures/ppv/f12.png" data-background-size="contain">
<h2>&nbsp;</h2>
</section>
<section id="section-17" class="slide level2 center" data-background-color="LightCyan">
<h2></h2>
<blockquote>
<p><strong>N.B.</strong>: The amount of information provided by a test result is called the result’s <strong>Bayes factor</strong>, <span class="math inline">\(K\)</span>.</p>
<div class="fragment">
<p>While the PPV—which is the <strong>posterior probability</strong> of disease given a positive test—changes depending on the prior, the following <strong>ratios</strong> are always proportional:</p>
<p><span class="math display">\[ \frac{\mathrm{Pr}(\textrm{actually }+ \mid \textrm{test }+)}{\mathrm{Pr}(\textrm{actually }- \mid \textrm{test }+)} = K\,\frac{\mathrm{Pr}(\textrm{actually }+)}{\mathrm{Pr}(\textrm{actually }-)}\]</span></p>
</div>
<div class="fragment">
<p>So, the Bayes factor tells us how much receiving a positive test result <strong>changes</strong> our prior belief. Test results with larger Bayes factors <strong>change our beliefs more</strong>.</p>
</div>
</blockquote>
</section></section>
<section>
<section id="tests-in-science" class="title-slide slide level1 center" data-background-color="FireBrick">
<h1>Tests in science</h1>

</section>
<section id="tests-in-science-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Tests in science</h2>
<p>&nbsp;</p>
<p>For Covid testing, we obtained some bit of noisy data (a positive test result), and sought to <strong>infer</strong> something about what was <strong>actually</strong> happening (whether we truly have Covid).</p>
<p><br>
We made this inference quantitative using the Covid RT-PCR test’s <strong>PPV</strong>:</p>
<p><span class="math display">\[ \mathrm{PPV} = \mathrm{Pr}(\textrm{actually }+ \mid \textrm{test }+) \]</span></p>
</section>
<section id="tests-in-science-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Tests in science</h2>
<p><br>
&nbsp;</p>
<p>In science, we use <strong>statistical tests</strong>.</p>
<p><br>
Just like the Covid RT-PCR, statistical tests are <strong>noisy</strong> bits of data. What we would like to do is to <strong>infer</strong> something about what is <strong>actually</strong> happening in the world on the basis of these test results.</p>
</section>
<section id="examplecorrelation" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title"><em>Example</em>—Correlation</h2>
<p>Let’s say that you’re analyzing some data. You plug two variables you’re working on, <code>x</code> and <code>y</code>, into a magic black box like <code>scipy.stats.pearsonr</code>, and it pops out:</p>
<p>&nbsp;</p>
<div class="fragment">
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb16-1" class="hljs-ln-code"><a href=""></a><span class="op">&gt;&gt;&gt;</span> scipy.stats.pearsonr( x, y )</span>
<span id="cb16-2" class="hljs-ln-code"><a href=""></a>(<span class="fl">0.21365304326850618</span>, <span class="fl">0.03281172835181021</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<blockquote>
<p>(The first value is the correlation <span class="math inline">\(r\)</span>, the second is the <span class="math inline">\(p\)</span>-value.)</p>
</blockquote>
</div>
<div class="fragment">
<p><br>
Cool, it’s significant! We got a <strong>positive test result</strong>.</p>
</div>
</section>
<section id="examplecorrelation-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title"><em>Example</em>—Correlation</h2>
<p>&nbsp;</p>
<p>Given this:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb17-1" class="hljs-ln-code"><a href=""></a><span class="op">&gt;&gt;&gt;</span> scipy.stats.pearsonr( x, y )</span>
<span id="cb17-2" class="hljs-ln-code"><a href=""></a>(<span class="fl">0.21365304326850618</span>, <span class="fl">0.03281172835181021</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<h3 id="section-18">&nbsp;</h3>
<h3 id="what-do-you-now-know-about-whether-there-is-actually-a-relationship-between-x-and-y">… what do you now know about whether there is <u>actually</u> a relationship between <code>x</code> and <code>y</code>?</h3>
</section>
<section id="examplecorrelation-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title"><em>Example</em>—Correlation</h2>
<p>&nbsp;</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb18-1" class="hljs-ln-code"><a href=""></a><span class="op">&gt;&gt;&gt;</span> scipy.stats.pearsonr( x, y )</span>
<span id="cb18-2" class="hljs-ln-code"><a href=""></a>(<span class="fl">0.21365304326850618</span>, <span class="fl">0.03281172835181021</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This information, by itself, is <strong>not a statement about whether the null hypothesis is actually true or false</strong>—just as a positive Covid test is not, by itself, a statement about whether you actually have Covid.</p>
<div class="fragment">
<p>&nbsp;</p>
<h3 id="we-must-infer-the-truth-from-the-test">We must infer the truth from the test</h3>
</div>
<div class="fragment">
<!-- -->
<h4 id="what-does-this-inference-depend-on">What does this inference depend on?</h4>
</div>
</section>
<section id="examplecorrelation-3" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title"><em>Example</em>—Correlation</h2>
<p>&nbsp;</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb19-1" class="hljs-ln-code"><a href=""></a><span class="op">&gt;&gt;&gt;</span> scipy.stats.pearsonr( x, y )</span>
<span id="cb19-2" class="hljs-ln-code"><a href=""></a>(<span class="fl">0.21365304326850618</span>, <span class="fl">0.03281172835181021</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>With our shiny positive test result, what we really care about is the <strong>posterior probability</strong>, given we saw this test result, of whether there is a relationship between <code>x</code> and <code>y</code>. This is precisely the <strong>PPV</strong>:</p>
<p><span class="math display">\[ \mathrm{PPV} := \mathrm{Pr}(\textrm{actually a relationship} \mid \textrm{test rejects null hyp.}) \]</span></p>
</section>
<section id="examplecorrelation-4" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title"><em>Example</em>—Correlation</h2>
<p>&nbsp;</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb20-1" class="hljs-ln-code"><a href=""></a><span class="op">&gt;&gt;&gt;</span> scipy.stats.pearsonr( x, y )</span>
<span id="cb20-2" class="hljs-ln-code"><a href=""></a>(<span class="fl">0.21365304326850618</span>, <span class="fl">0.03281172835181021</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[ \mathrm{PPV} := \mathrm{Pr}(\textrm{actually a relationship} \mid \textrm{test rejects null hyp.}) \]</span></p>
<p>But, just as before with Covid RT-PCR,</p>
<h3 id="ppv-depends-on-our-prior-knowledge-of-whether-there-is-a-real-relationship-between-x-and-y">PPV depends on <u>our prior knowledge</u> of whether there is a real relationship between <code>x</code> and <code>y</code>—</h3>
<p>not just the characteristics of <code>pearsonr</code>!</p>
</section>
<section id="examplecorrelation-5" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title"><em>Example</em>—Correlation</h2>
<p>&nbsp;</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb21-1" class="hljs-ln-code"><a href=""></a><span class="op">&gt;&gt;&gt;</span> scipy.stats.pearsonr( x, y )</span>
<span id="cb21-2" class="hljs-ln-code"><a href=""></a>(<span class="fl">0.21365304326850618</span>, <span class="fl">0.03281172835181021</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Suppose I got this result by going out into the world and running the <code>pearsonr</code> function between every pair of two datasets I could get my hands on.</p>
<div class="fragment">
<p>What is the probability that any two of those randomly chosen datasets are <strong>actually</strong> causally related to one another? That is, what is the <strong>prior</strong>,</p>
<p><span class="math display">\[ \mathrm{Pr}(\textrm{actually a relationship}) \]</span></p>
</div>
</section>
<section id="examplecorrelation-6" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title"><em>Example</em>—Correlation</h2>
<p>&nbsp;</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb22-1" class="hljs-ln-code"><a href=""></a><span class="op">&gt;&gt;&gt;</span> scipy.stats.pearsonr( x, y )</span>
<span id="cb22-2" class="hljs-ln-code"><a href=""></a>(<span class="fl">0.21365304326850618</span>, <span class="fl">0.03281172835181021</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>&nbsp;</p>
<p>What is the probability that any two of those randomly chosen datasets are <strong>actually</strong> causally related to one another? That is, what is the <strong>prior</strong>,</p>
<p><span class="math display">\[ \mathrm{Pr}(\textrm{actually a relationship}) \]</span></p>
<h3 id="it-is-astronomically-small.">It is astronomically small.</h3>
</section>
<section id="examplecorrelation-7" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title"><em>Example</em>—Correlation</h2>
<p>&nbsp;</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb23-1" class="hljs-ln-code"><a href=""></a><span class="op">&gt;&gt;&gt;</span> scipy.stats.pearsonr( x, y )</span>
<span id="cb23-2" class="hljs-ln-code"><a href=""></a>(<span class="fl">0.21365304326850618</span>, <span class="fl">0.03281172835181021</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>&nbsp;</p>
<p>In this experimental setup of <strong>randomly testing</strong> correlations, what is the <strong>PPV</strong>?</p>
<div class="fragment fade-down">
<p>&nbsp;</p>
<h3 id="it-is-exceedingly-low.">It is exceedingly low.</h3>
</div>
</section>
<section id="examplecorrelation-8" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title"><em>Example</em>—Correlation</h2>
<p>&nbsp;</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb24-1" class="hljs-ln-code"><a href=""></a><span class="op">&gt;&gt;&gt;</span> scipy.stats.pearsonr( x, y )</span>
<span id="cb24-2" class="hljs-ln-code"><a href=""></a>(<span class="fl">0.21365304326850618</span>, <span class="fl">0.03281172835181021</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>&nbsp;</p>
<p>So, how do I interpret this result I just saw, that <code>pearsonr</code> rejected the null hypothesis of no relationship between <code>x</code> and <code>y</code>?</p>
<div class="fragment fade-down">
<p>&nbsp;</p>
<h3 id="it-is-probably-a-false-positive.">It is probably a false positive.</h3>
</div>
</section>
<section id="section-19" class="slide level2 center" data-background-color="IndianRed">
<h2></h2>
<h3 id="does-that-mean-that-scipy.stats.pearsonr-is-a-bad-test">Does that mean that <code>scipy.stats.pearsonr</code> is a bad test?</h3>
<p><br>
&nbsp;</p>
<div class="fragment fade-down">
<!-- -->
<h3 id="is-covid-rt-pcr-a-bad-test">Is Covid RT-PCR a bad test?</h3>
</div>
</section>
<section id="no." class="slide level2 center" data-background-color="FireBrick">
<h2>No.&nbsp;</h2>
<div class="fragment">
<p>&nbsp;</p>
<p><strong>PPV</strong> isn’t just about the test.</p>
<p>PPV depends on <strong>how the test is used</strong>.</p>
</div>
</section>
<section id="recall-1" class="slide level2">
<h2>Recall</h2>
<p>When looking at Covid testing, <strong>increasing our prior belief of Covid infection to just 5%</strong> raised the PPV from 5% to 60%, <strong>for the exact same test</strong>. To make the test’s results more meaningful, we used <strong>knowledge</strong> of prior exposure to Covid to <strong>choose who to test</strong>.</p>
<div id="6e7c6d7c" class="cell" data-execution_count="19">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="bayes_files/figure-revealjs/cell-20-output-1.png" width="984" height="327"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-20" class="slide level2 center" data-background-color="PaleGreen">
<h2></h2>
<h3 id="even-very-weak-information-can-dramatically-improve-the-utility-of-a-test">Even very weak information can dramatically improve the utility of a test!</h3>
<div class="fragment">
<p>&nbsp;</p>
<p>So, how do you <strong>improve the positive predictive value</strong> of testing for significant correlations?</p>
</div>
<div class="fragment fade-down">
<!-- -->
<h3 id="choose-the-right-questions-to-ask.">Choose the right questions to ask.</h3>
</div>
</section>
<section id="a-clairvoyant-mouse-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">A clairvoyant mouse?</h2>
<p>&nbsp;</p>
<p>You look at your data, and you see that you <strong>reject the null hypothesis</strong> that <em>manipulated mice do not predict the future</em> with a <span class="math inline">\(p\)</span>-value of 0.014.</p>
<div class="fragment fade-down">
<p>&nbsp;</p>
<h4 id="what-do-you-now-know-about-whether-the-mouse-is-actually-clairvoyant">What do you now know about whether the mouse is actually clairvoyant?</h4>
</div>
<div class="fragment fade-down">
<p>&nbsp;</p>
<h4 id="why-do-you-think-this">Why do you think this?</h4>
</div>
</section>
<section id="a-clairvoyant-mouse-3" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">A clairvoyant mouse?</h2>
<p>&nbsp;</p>
<p>You look at your data, and you see that you <strong>reject the null hypothesis</strong> that <em>manipulated mice do not predict the future</em> with a <span class="math inline">\(p\)</span>-value of 0.014.</p>
<p>&nbsp;</p>
<h3 id="what-do-you-do-with-this-information-1">What do you do with this information?</h3>
</section></section>
<section>
<section id="summary" class="title-slide slide level1 center" data-background-color="bisque">
<h1>Summary</h1>

</section>
<section id="section-21" class="slide level2 center" data-background-color="purple">
<h2></h2>
<div class="columns">
<div class="column" style="width:35%;">
<h3 id="tests-do-not-tell-us-the-truth.">Tests do not tell us the truth.</h3>
</div><div class="column" style="width:65%;">
<p><br>
<br>
&nbsp;</p>
<p><img data-src="figures/ppv/f13.png"></p>
<h4 id="we-try-to-infer-the-truth-from-tests.">We try to <u><strong>infer</strong></u> the truth from tests.</h4>
</div></div>
</section>
<section id="section-22" class="slide level2 center" data-background-color="gold">
<h2></h2>
<div class="columns">
<div class="column" style="width:62%;">
<p><img data-src="figures/ppv/f12.png"></p>
<h4 id="because-we-live-in-a-special-part-of-the-multiversethe-part-where-we-saw-what-we-saw">Because we live in a special part of the multiverse—the part where <u>we saw what we saw</u>!</h4>
</div><div class="column" style="width:38%;">
<p><br>
&nbsp;</p>
<h3 id="tests-update-our-beliefs-about-the-world.">Tests update our beliefs about the world.</h3>
</div></div>
</section>
<section id="section-23" class="slide level2 center" data-background-color="SteelBlue">
<h2></h2>
<div class="columns">
<div class="column" style="width:40%;">
<p><br>
&nbsp;</p>
<h3 id="the-predictive-value-of-a-test-depends-on-how-the-test-is-used.">The predictive value of a test depends on how the test is used.</h3>
</div><div class="column" style="width:60%;">
<p><img data-src="figures/ppv/f11.png"></p>
<h4 id="in-particular-it-depends-on-our-prior-knowledge-of-what-we-are-testing-for.">In particular, it depends on our <u>prior knowledge</u> of what we are testing for.</h4>
</div></div>
</section>
<section id="section-24" class="slide level2" data-background-color="PaleGreen">
<h2></h2>
<h3 id="statistical-testing-is-not-just-a-matter-of-selecting-the-correct-test-for-a-given-question.">Statistical testing is not just a matter of selecting the “correct” test for a given question.</h3>
<div class="fragment">
<p>&nbsp;</p>
<p>Being judicious about selecting the correct <strong>questions</strong> to apply the test <strong>to</strong> is a more powerful way to</p>
</div>
<div class="fragment">
<ul>
<li>strengthen the inferences gained through statistics;</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>improve the reproducibility of science; and</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>more responsibly use resources, like experimental animals, that we have an ethical obligation to minimize.</li>
</ul>
</div>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="bayes_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="bayes_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="bayes_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="bayes_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="bayes_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="bayes_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="bayes_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="bayes_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="bayes_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="bayes_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'slide',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>